# Project 8 - Pentesting Live Targets

Time spent: **7-8** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

Vulnerability #1: SQL Injection
  - [ ] GIF Walkthrough:
    <img src="https://github.com/ksoliman/PentestLiveTargets/blob/master/wk8_GIFs/SQL_Injection.gif" width="800">
  - [ ] Steps to recreate:
    - On the page to view a salespersons coverage region, in the URL, an id is set for every salesperson
    - Replace the id number with ```' OR SLEEP(5)=0--'``` and hit "Enter"
    - The injection is successful if the webpage takes 5 seconds to reload 
  
Vulnerability #2: Session Hijacking/Fixation
  - [ ] GIF Walkthrough:
    <img src="https://github.com/ksoliman/PentestLiveTargets/blob/master/wk8_GIFs/Session_Hijacking.gif" width="800">
  - [ ] Steps to recreate:
    - Copied the PHPSESSIONID (using web inspector) of an authenticated administrator session in any color version of the webpage (using Safari)
    - Pasted the PHPSESSIONID in an attackers session (before log in) in the blue webpage and hit "Enter"
    - The attacker will now be authenticated as an admin without login credentials

## Green

Vulnerability #1: User Enumeration
  - [ ] GIF Walkthrough:
    <img src="https://github.com/ksoliman/PentestLiveTargets/blob/master/wk8_GIFs/User_Enumeration.gif" width="800">
  - [ ] Steps to recreate:
    - Enter a known username in the username field, and any random password string
    - Examine the login error
    - Enter a username that is most likely to not exist, and any random password string
    - Examine the login error
      - Difference between the two errors is the boldface applied to the error when a username is correct and a password is not
      - When the username does not exist, the error is not bold
      - Upon inspection of the webpage after receiving an error, the developers mistake is revealed in that bolding was applied to the error in one case but not all cases, regardless of whether or not the username exists 
  
Vulnerability #2: Stored XSS
  - [ ] GIF Walkthrough:
    <img src="https://github.com/ksoliman/PentestLiveTargets/blob/master/wk8_GIFs/Stored_XSS.gif" width="800">
  - [ ] Steps to recreate:
    - As an unauthenticated attacker, navigate to the feedback page
    - In the name field, paste ```<script>alert('______ found the XSS!');</script>``` and continue to fill out the remaining fields in the form, then submit
      - In this walkthrough, the script was submitted with the generic "mallory" name as a test before recording, which explains mallory's name appearing several times when the admin opens the feedback page
    - As an authenticated admin, navigate to the feedback page
    - Attack is successful if a pop up appears with the message the attacker entered in the submitted script

## Red

Vulnerability #1: Insecure Direct Object Referencing
  - [ ] GIF Walkthrough:
    <img src="https://github.com/ksoliman/PentestLiveTargets/blob/master/wk8_GIFs/Insecure_Direct_Object_Referencing.gif" width="800">
  - [ ] Steps to recreate:
    - On the page to view a salespersons coverage region, in the URL, an id is set for every salesperson
    - Upon changing the id value to "10" or "11" and resubmitting, the webpage loads information of a salesperson that is not supposed to be publicized and a salesperson that was fired, respectively
  
Vulnerability #2: Cross-Site Request Forgery
  - [ ] GIF Walkthrough:
  <img src="https://github.com/ksoliman/PentestLiveTargets/blob/master/wk8_GIFs/CSRF.gif" width="800">
  - [ ] Steps to recreate:
    - As an attacker, create a form consisting of:   
```<html>
  <head>
    <title>Fake Form</title>
  </head>
  <body>
    <form action="https://35.226.115.248/red/public/staff/salespeople/edit.php?id=1" method="POST" name="edit_salesperson">
      <input type="text" name="first_name" value="Daron" />
      <input type="text" name="last_name" value="Burger" />
      <input type="submit" value="submit" />
    </form>
  </body>
</html>```
      - Notice the "last_name" is "Burger"
   - Paste the link to this form in a comment in the feedback page and submit it
   - As an authenticated admin, navigate to the feedback page and click the link planted by the attacker
   - If successful, a blank page will result from clicking the link
   - Upon checking the salesperson Daron Burkes name in the salesperson list, the last name will be changed to "Burger"
   NOTE: This GIF was created on a TPM's computer (by me), due to technical issues on my laptop in getting the html page to load properly
      


## Notes

HTML page created for the CSRF attack would just open up the text used for the attack, but would not actually execute. Needed to use a TPM's computer to record the GIF
